<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HL7 Viewer</title>
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/viewer.css">
</head>
<body>
  <div class="app-container">
    <!-- Top Menu Bar -->
    <header class="menu-bar">
      <div class="menu-left">
        <h1 class="app-title">HL7 Viewer</h1>
        <button id="downloadLocalBtn" class="download-local-btn">Download Local Application</button>
      </div>
      <div class="menu-controls">
        <div class="control-group">
          <label class="control-label">View Mode:</label>
          <div class="view-toggle">
            <label class="toggle-option">
              <input type="radio" name="viewMode" value="collapsed" checked>
              <span class="toggle-btn">Tree View</span>
            </label>
            <label class="toggle-option">
              <input type="radio" name="viewMode" value="standard">
              <span class="toggle-btn">Textual View</span>
            </label>
          </div>
        </div>
        <div class="control-group">
          <label class="checkbox-control">
            <input type="checkbox" id="hideEmptyFields">
            <span class="checkbox-label">Hide Empty Fields</span>
          </label>
        </div>
        <div class="control-group">
          <label class="control-label" for="messagesPerBatch">Batch Size:</label>
          <select id="messagesPerBatch" class="select-control">
            <option value="20">20</option>
            <option value="50">50</option>
            <option value="100">100</option>
          </select>
        </div>
        <button id="clearBtn" class="clear-btn" title="Clear viewer">Clear</button>
      </div>
    </header>

    <!-- Main Content Area -->
    <main class="main-content">
      <!-- Input Area -->
      <div class="input-area" id="inputArea">
        <div class="drop-zone" id="dropZone">
          <div class="drop-zone-content">
            <div class="drop-icon">&#128196;</div>
            <p class="drop-text">Drag & drop HL7 or JSON files here</p>
            <p class="drop-subtext">or</p>
            <label class="file-input-label">
              <input type="file" id="fileInput" accept=".hl7,.json,.txt" multiple>
              <span class="browse-btn">Browse Files</span>
            </label>
          </div>
        </div>

        <div class="text-input-area">
          <textarea id="textInput" placeholder="Or paste HL7/JSON content here..."></textarea>
          <button id="loadBtn" class="load-btn">Load Content</button>
        </div>
      </div>

      <!-- Viewer Area -->
      <div class="viewer-area" id="viewerArea">
        <div class="hl7-container" id="viewerContainer">
          <div class="welcome-message">
            <p>Upload a file or paste content to view HL7/JSON data</p>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Download Local Application Modal -->
  <div class="modal-overlay" id="downloadModal">
    <div class="modal">
      <div class="modal-header">
        <h2 class="modal-title">Download Local Application</h2>
        <button class="modal-close" id="modalCloseBtn">&times;</button>
      </div>
      <div class="modal-body">
        <div class="modal-notice">
          <p>If you intend to use this application with Protected Health Information (PHI), you should only run it locally on your own machine. Running locally ensures that no data leaves your device.</p>
        </div>
        <div class="modal-disclaimer">
          <strong>Disclaimer:</strong> Never enter PHI into any application you do not fully understand. Before using any tool with sensitive data, verify how it processes, stores, and transmits information. This application runs entirely in your browser with no server-side data processing, but you are responsible for confirming that yourself.
        </div>
        <section class="modal-section">
          <h3>1. Clone the Repository</h3>
          <p>Open a terminal and run:</p>
          <div class="code-block">
            <code>git clone https://github.com/zachromers/HL7Viewer.git</code>
            <button class="copy-code-btn" data-copy="git clone https://github.com/zachromers/HL7Viewer.git" title="Copy to clipboard">&#128203;</button>
          </div>
          <p>Or <a href="https://github.com/zachromers/HL7Viewer/archive/refs/heads/master.zip" target="_blank" rel="noopener">download the ZIP</a> directly from GitHub and extract it.</p>
        </section>

        <section class="modal-section">
          <h3>2. Open in Chrome</h3>
          <p>Navigate to the cloned folder and open the file:</p>
          <div class="code-block">
            <code>HL7Viewer/public/index.html</code>
          </div>
          <p>Right-click the file and choose <strong>Open with &rarr; Google Chrome</strong>, or drag it into an open Chrome window.</p>
        </section>

        <section class="modal-section">
          <h3>3. Create a Desktop Shortcut</h3>
          <ol>
            <li>Right-click on <code>index.html</code> in the <code>public</code> folder.</li>
            <li>Select <strong>Send to &rarr; Desktop (create shortcut)</strong>.</li>
            <li>Optionally, rename the shortcut to <strong>HL7 Viewer</strong>.</li>
          </ol>
        </section>

        <section class="modal-section">
          <h3>4. Add a Chrome Bookmark</h3>
          <ol>
            <li>Open <code>index.html</code> in Chrome.</li>
            <li>Press <kbd>Ctrl</kbd>+<kbd>D</kbd> (or <kbd>Cmd</kbd>+<kbd>D</kbd> on Mac).</li>
            <li>Name the bookmark <strong>HL7 Viewer</strong> and choose a folder.</li>
            <li>Click <strong>Done</strong>.</li>
          </ol>
        </section>
      </div>
    </div>
  </div>

  <script src="js/hl7-fields.js"></script>
  <script src="js/hl7-parser.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
